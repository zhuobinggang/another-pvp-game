> Bugs fix should not be written in todos.

- [ ] #1 前端
  - [ ] #1.1 To complete monster module.
    - [ ] #1.1.1 I need to make the monsters wander randomly.
	- [ ] #1.1.2 To make the bullet fly toward in where player is facing.
  - [ ] #1.2 做一个启动页面包含项目：单人游戏， 多人游戏。不同的选择进入不同的scene，这个scene对自己拥有的sprite进行update，但是保留通用逻辑如子弹飞行，碰撞，撞墙后爆炸等。
    - [ ] #1.2.1 重构game.js将所有单人游戏scene里的逻辑对象装进新的container里，组织成一个component。
  - [ ] #1.3 对可操作物体进行抽象，如玩家，怪物。比如调用这个物体的left方法，就会一直向左走并且播放动画。
    - [ ] #1.3.1 参考`https://docs.cocos.com/creator/manual/zh/getting-started/quick-start.html` 的 移动控制 栏目下的方法对键盘控制做抽象, 目标是将逻辑独立到文件里面去
  - [ ] #1.4 使用工具简化流程
    - [ ] #1.4.1 使用tiled生成带动画的地图并完成文档
    - [ ] #1.4.2 使用texturepacker生成spritesheet, 并思考跟tiled的分工
    - [ ] #1.4.3 使用dragon bone制造龙骨动画并加载成AnimatedSprite
    - [X] #1.4.4 手写tiled json文件格式解析器， 这个要抓紧时间解决
      - [X] #1.4.4.1 将custom有属性的tile全部提取出来保存到一个数组里
      - [X] #1.4.4.2 完成解析animated sprite 
      - [X] #1.4.4.3 [Bugfix] tiled的anchor错位导致最上面一行被隐藏
    - [X] #1.4.5 理解怎么把源码导出为单一的js文件供浏览器调用, 并成功调用tiledJs和dragonBonesJs
  - [X] #1.5 尝试能不能所有界面都用tiled来做
    - [X] #1.5.1 尝试把开始界面用tiled做出来 包含进入单人游戏 进入多人游戏 这两个按钮 还有其他背景之类的东西
  - [ ] #1.6 界面素材与设计以及制作
    - [X] #1.6.1 [yuuzu] `start-scene`设计与素材
    - [X] #1.6.2 `start-scene`实际制作
    - [X] #1.6.3 [yuuzu] 多人游戏弹窗设计与素材
    - [X] #1.6.4 多人游戏弹窗实际制作
      - [X] #1.6.4.1 在弹窗的按钮上标注数字
      - [X] #1.6.4.2 在弹窗的输入框标注数字
      - [X] #1.6.4.3 在输入框右边放一个退格按钮删除数字
    - [X] #1.6.5 准备房间制作, 测试scene的抽象, 可以多场景切换
  - [X] #1.7 将弹窗功能提取为组件 
  - [X] #1.8 按钮渐变, 将按钮提取为组件
    - [X] #1.8.1 将按钮写成typescript文件
  - [ ] #1.9 自动横屏
  - [X] #1.10 A star 算法让NPC进行寻路
  - [X] #1.11 摇杆控制玩家行走
  - [X] #1.12 镜头居中，跟随
    - [X] #1.12.1 镜头不能超出墙边
  - [X] #1.13 UI组件浮动在窗口上
    - [X] #1.13.1  制作view组件, 调用moveTo(x, y)就能移动到指定位置
  - [X] #1.14 每个场景保留自己的timer 离开该场景后停止所有更新
  - [X] #1.15 拖拽镜头效果(优先制作, 好了之后这个技术可以直接用在摇杆上)
  - [ ] #1.16 通过tmx初始化玩家位置
  - [X] #1.17 碰撞检测不能撞墙，用box2d或者collision2d
  - [X] #1.18 完成遮挡效果的制作, 原理参考doc文件夹下相应文档
    - [X] #1.18.1 遮挡效果需要检测碰撞但是不能被撞开，实现监听后判断碰撞是不是遮挡物的关系，如果是就contact.setEnabled(false)
  - [X] #1.19 完成准备房间的制作
  - [X] #1.20 为了保留准备房间信息，玩家从准备房间场景到多人场景的时候，不应该调用ready room quit， 这样会导致发送退出房间信息， 改为调用hide， 只隐藏场景
  - [X] #1.21 一开始初始化玩家角色的时候， 设置状态为冻结， 不响应操作， 等待服务器信息下来之后才显示在目标位置并激活
    - [ ] #1.21.1 初始化自己角色的时候，就需要在scene.playerMap里面加入自己的ID => player对象了, 然后inited也要设置为true
  - [ ] #1.22 根据服务器信息初始化其他玩家
  - [ ] #1.23 
  - [ ] #1.24 完成高效ticker解决方案
    - [ ] #1.24.1 [???]如果一个动画单位死掉了，我要怎么在ticker里面删掉它
    - [X] #1.24.2 [TEST]如果一个动画单位destroy掉了，看看ticker会不会报错. A: 会报错，所以这个必须解决
  - [X] #1.25 setPosition同时要完成physical body和sprite的位移, 不然在update里面会以physical body为准.
  - [ ] #1.26 为其他玩家设置碰撞框(有必要，不能跟别的撞)
  - [ ] #1.27 根据服务器下发的帧信息顺滑地移动玩家,并且根据方向播放动画 
    - [X] #1.27.1 首先能够移动玩家
    - [X] #1.27.2 顺滑地移动玩家 
    - [X] #1.27.3 根据方向播放动画 
  - [ ] #1.28 前后端健壮性问题: (!!!!!!!!!!!!!!!) 
    - [ ] #1.28.1 游戏结束后返回准备房间, 后端清除room.game, 再开不会有残留问题
    - [ ] #1.28.2 如果玩家断联， 应该退出多人游戏，退出房间
    - [ ] #1.28.3 重新进入多人游戏房间问题，如何清除所有残留游戏状态？
  - [X] #1.29 跟随玩家信息栏模块
  - [ ] #1.30 怪物模块
    - [X] #1.30.1 根据后端信息显示怪物
    - [X] #1.30.2 与玩家的距离低于一定阈值的时候，向所有客户端发送发射信息，然后在服务器端生成子弹, 依赖#1.31
    - [X] #1.30.3 设定HP，判断与子弹发生碰撞时扣除HP
    - [X] #1.30.4 根据子弹的srcId储存伤害map, 用于最后的分数结算
    - [X] #1.30.5 怪物状态机: 每两秒做一次决策，%50发起攻击，%50朝最近一个角色以40pixels/second的速度移动
      - [X] #1.30.5.1 前端监听monster move和monster stop事件
    - [X] #1.30.6 怪物方向
  - [X] #1.31 攻击模块
    - [X] #1.31.1 后端碰撞检测, 用于判断子弹伤害

-----------------------------
1. 冰枪术的body OK
2. 琪露诺的HP组件 OK
3. 琪露诺的动画效果 OK
4. 琪露诺BOSS登场动画 OK
5. 倒计时 OK
6. 如果倒计时结束仍然没有打倒boss，在结算显示失败
7. 子弹爆炸效果
8. 公告效果 OK
9. 玩家死亡不能再行动
-----------------------------


      - [X] #1.31.1.1 先从玩家碰撞框以及子弹碰撞框开始，撞到就扣血,并让子弹消失. 不需要模拟物理效果,用sat-js
        - [X] 玩家碰撞框
        - [X] 子弹碰撞框
        - [X] 怪物碰撞框, 与子弹和玩家发生碰撞时都触发扣血
      - [X] #1.31.1.2 前端监听hp_change事件, 子弹消亡在前端做判断，不需要后端传数值过来
      - [X] #1.31.1.3 后端用map管理子弹，在主ticker里面加入判断，如果超过最大生命周期即将指针指向空并且将物理body摧毁
      - [X] #1.31.1.4 Tick的时候对collidableWorld里面所需对象组进行碰撞检测
      - [X] #1.31.1.5 测试可用： 如果玩家发生碰撞，使他们的血量为0
    - [X] #1.31.2 提供攻击按钮
    - [X] #1.31.3 能够创建子弹
  - [X] #1.32 结束游戏状态
  - [X] #1.33 (Refer to document folder) 根据玩家的ws连接所处状态(登录后，断联，游戏中...), 画出意外断联应该如何应对的状态机
  - [X] #1.34 想好怎么做结算页面，结合进入游戏&返回房间的逻辑, 画出状态机
  - [X] #1.35 [BUG] 如果现在退回到准备房间多次会调用结算弹框
  - [X] #1.36 [TEST] 测试PIXI的ticker是不是每秒钟60帧 A:是
  - [X] #1.37 结算模块
    - [X] #1.37.1 在准备房间显示结算框
    - [X] #1.37.2 显示结算信息
  - [X] #1.38 攻击冷却时间: 在后面绘制扇形, 攻击之后按钮半透明并且interactive=false
  - [ ] #1.39 [BUG] 上一局的子弹没有清空
  - [ ] #1.40 [TEST] 猜想如果父容器设定了缩放，放进来的子节点也会适应这个缩放
  - [ ] #1.41 血量条, 在屏幕上方增加悬浮框，实时显示所有人的血量
  - [ ] #1.42 仓库模块
    - [ ] #1.42.1 增加另一个角色。因为还没做好所以可以先通过修改全局变量来测试
    - [X] #1.42.2 增加近战武器。因为还没做好所以可以先通过修改全局变量来测试
      - [X] #1.42.2.1 全局增加window.config.weapon = sword, 然后增加剑气的子弹类型, 速度很小，一秒消失
    - [X] #1.42.3 增加黏液球武器，给怪物使用
    - [X] #1.42.4 增加选中高亮效果，使用Graphic来绘制高亮框
  - [X] #1.43 浮现红色的数字表现扣血效果
  - [ ] #1.44 怪物碰撞掉血
  - [ ] #1.45 在实时血量框里面显示玩家所持武器
  - [ ] #1.46 在实时血量框显示玩家头像
  - [ ] #1.47 增加boss怪物, 当检测到所有的小怪物都死绝之后, spawn一个boss，并且向前端发送消息
    - [ ] #1.48 Q：是否需要增加spawnMonster信息
  - [ ] #1.48 游戏体验优化：
    - [ ] #1.48.1 浮现式公告

---

- [ ] #2 后端
  - [ ] #2.1 To do Storage designs
    - [ ] #2.1.1 To do User table design
    - [ ] #2.1.2 To do Player table design
  - [x] #2.2 快速实现一个在线小程序验证server-design文档根据位置信息来同步的可行性
  - [ ] #2.3 加入用#2.2的实现方式对实现多人游戏scene
  - [ ] #2.4 后端架构设计
    - [ ] #2.4.1 完成状态机图 url: `https://drive.google.com/file/d/17P-MQfSz6jJmApBGObUQ_RhrWd18aUQ2/view?usp=sharing`
    - [ ] #2.4.2 完成后端架构编写
  - [ ] #2.5 完成简单的位置同步
    - [ ] #2.5.1 待每个人都准备好之后进入多人游戏地图，先设定几个硬编码的坐标， 随机分配
  
  - [X] #2.6 new Game()的时候传入房间所有玩家信息，方便使用昵称等，而且用于统计准备状况，分析是否所有人都准备好了.
  - [X] #2.7 开始游戏后发送怪物出生信息用于初始化怪物.
  - [ ] #2.8 游戏内，如果时间结束应该结束游戏并且将room.game回收
  - [X] #2.9 参考pixijs写一个ticker


